<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <title>day 12 | My iOS book</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 1.0.3">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    
    <link rel="next" href="../day_13/README.html" />
    
    
    <link rel="prev" href="../day_11/README.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../gitbook/style.css">


        
    <div class="book"  data-level="12" data-basepath=".." data-revision="1473742693053">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" data-path="day_01/README.html">
            
                
                    <a href="../day_01/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         day 01
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2" data-path="day_02/README.html">
            
                
                    <a href="../day_02/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         day 02
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="3" data-path="day_03/README.html">
            
                
                    <a href="../day_03/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         day 03
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4" data-path="day_04/README.html">
            
                
                    <a href="../day_04/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                         day 04
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5" data-path="day_05/README.html">
            
                
                    <a href="../day_05/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                         day 05
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="6" data-path="day_06/README.html">
            
                
                    <a href="../day_06/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                         day 06
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="7" data-path="day_07/README.html">
            
                
                    <a href="../day_07/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                         day 07
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="8" data-path="day_08/README.html">
            
                
                    <a href="../day_08/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                         day 08
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="9" data-path="day_09/README.html">
            
                
                    <a href="../day_09/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                         day 09
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="10" data-path="day_10/README.html">
            
                
                    <a href="../day_10/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                         day 10
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="11" data-path="day_11/README.html">
            
                
                    <a href="../day_11/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                         day 11
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter active" data-level="12" data-path="day_12/README.html">
            
                
                    <a href="../day_12/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                         day 12
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="13" data-path="day_13/README.html">
            
                
                    <a href="../day_13/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                         day 13
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="14" data-path="day_14/README.html">
            
                
                    <a href="../day_14/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                         day 14 
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">Twitter</button>
                <button type="button" data-sharing="google-plus" class="button">Google</button>
                <button type="button" data-sharing="facebook" class="button">Facebook</button>
                <button type="button" data-sharing="weibo" class="button">Weibo</button>
                <button type="button" data-sharing="instapaper" class="button">Instapaper</button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >My iOS book</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-gitbook_44097">
                    
                        <h1 id="day-12">day 12</h1>
<h2 id="">事件处理</h2>
<ul>
<li>简介</li>
<li>UIView的触摸事件</li>
<li>最合适的View</li>
<li>事件响应</li>
<li>手势识别</li>
</ul>
<hr>
<h4 id="">事件处理</h4>
<ul>
<li>iOS中常用的事件分为三种<ul>
<li>触摸事件</li>
<li>加速计事件</li>
<li>远程控制事件</li>
</ul>
</li>
<li>响应者对象<ul>
<li>继承自<code>UIResponder</code> 的对象称为响应者</li>
<li><code>UIApplication</code>、<code>UIViewController</code>、<code>UIView</code>等，他们都是响应者对象，能够接收和处理事件</li>
</ul>
</li>
<li><code>UIResponder</code>类<ul>
<li>触摸事件<pre><code class="lang-objc">- (<span class="hljs-keyword">void</span>)touchesBegan:(<span class="hljs-built_in">NSSet</span> *)touches withEvent:(UIEvent *)event;
- (<span class="hljs-keyword">void</span>)touchesMoved:(<span class="hljs-built_in">NSSet</span> *)touches withEvent:(UIEvent *)event;
- (<span class="hljs-keyword">void</span>)touchesEnded:(<span class="hljs-built_in">NSSet</span> *)touches withEvent:(UIEvent *)event;
- (<span class="hljs-keyword">void</span>)touchesCancelled:(<span class="hljs-built_in">NSSet</span> *)touches withEvent:(UIEvent *)event;
</code></pre>
</li>
<li>加速计事件<pre><code class="lang-objc">- (<span class="hljs-keyword">void</span>)motionBegan:(UIEventSubtype)motion withEvent:(UIEvent *)event;
- (<span class="hljs-keyword">void</span>)motionEnded:(UIEventSubtype)motion withEvent:(UIEvent *)event;
- (<span class="hljs-keyword">void</span>)motionCancelled:(UIEventSubtype)motion withEvent:(UIEvent *)event;
</code></pre>
</li>
<li>远程控制事件<pre><code class="lang-objc">- (<span class="hljs-keyword">void</span>)remoteControlReceivedWithEvent:(UIEvent *)event;
</code></pre>
</li>
</ul>
</li>
<li>事件的产生和传递<ul>
<li>产生<pre><code>当发生一个触摸事件后，系统会将该事件加入到一个由UIApplication管理的事件队列中
UIApplication会从事件队列中取出最前面的事件，并将事件分发下去以便处理
</code></pre></li>
<li>传递<pre><code>主窗口会在视图层次结构中找到一个最合适的视图来处理触摸事件
触摸事件的传递是从父控件传递到子控件的
如果一个父控件不能接收事件，那么它里面的子控件也不能够接收事件
</code></pre></li>
<li>不能接受事件的情况<ol>
<li>不接收用户交互时不能够处理事件<pre><code>userInteractionEnabled = NO
</code></pre></li>
<li>当一个控件隐藏的时候不能够接收事件<pre><code>hidden = YES
</code></pre></li>
<li>当一个控件为透明白时候也不能够接收事件<pre><code>alpha = 0
</code></pre>· 注意<code>UIImageView</code>d的<code>userInteractionEnabled</code>默认为NO，因此<code>UIImageView</code>和它的子控件默认都不能接收事件</li>
</ol>
</li>
</ul>
</li>
</ul>
<hr>
<h4 id="uiview">UIView的触摸事件</h4>
<ul>
<li>要监听<code>UIView</code>的触摸事件，要使用自定义的view并实现<code>UIResponder</code>中的相应方法</li>
<li>主要事件<pre><code class="lang-objc"><span class="hljs-comment">// 一根或者多根手指开始触摸view，系统会自动调用view的下面方法.</span>
- (<span class="hljs-keyword">void</span>)touchesBegan:(<span class="hljs-built_in">NSSet</span> *)touches withEvent:(UIEvent *)event
<span class="hljs-comment">// 一根或者多根手指在view上移动时，系统会自动调用view的下面方法（随着手指的移动，会持续调用该方法，也就是说这个方法会调用很多次）</span>
- (<span class="hljs-keyword">void</span>)touchesMoved:(<span class="hljs-built_in">NSSet</span> *)touches withEvent:(UIEvent *)event
<span class="hljs-comment">// 一根或者多根手指离开view，系统会自动调用view的下面方法</span>
- (<span class="hljs-keyword">void</span>)touchesEnded:(<span class="hljs-built_in">NSSet</span> *)touches withEvent:(UIEvent *)event
</code></pre>
</li>
<li>参数说明<pre><code class="lang-objc">touches：
    touches中存放的都是UITouch对象，是一个<span class="hljs-built_in">NSSet</span>集合
    UITouch对象是用来保存手指相关联的信息，位置、时间、阶段等信息
    每一个手指对应一个UITouch对象，这个对象是系统自动为我们创建的，当手指移动时，系统会更新同一个UITouch对象，使它一直保存该手指的信息
    通过获取UITouch属性，我们可以获得触摸产生时所处的窗口，触摸的View，时间，点击的次数等
    还可以通过UITouch提供的方法获取当前手指所在的点,以及上一个手指所在的点
    - (<span class="hljs-built_in">CGPoint</span>)locationInView:(<span class="hljs-built_in">UIView</span> *)view;
    - (<span class="hljs-built_in">CGPoint</span>)previousLocationInView:(<span class="hljs-built_in">UIView</span> *)view;
event:
    每产生一个事件，就会产生一个UIEvent对象，记录事件产生的时刻和类型
</code></pre>
</li>
<li>触摸过程<ul>
<li>触摸开始<pre><code class="lang-objc">- (<span class="hljs-keyword">void</span>)touchesBegan:(<span class="hljs-built_in">NSSet</span> *)touches withEvent:(UIEvent *)event;
</code></pre>
</li>
<li>触摸移动<pre><code class="lang-objc">- (<span class="hljs-keyword">void</span>)touchesMoved:(<span class="hljs-built_in">NSSet</span> *)touches withEvent:(UIEvent *)event;
</code></pre>
</li>
<li>触摸结束<pre><code class="lang-objc">- (<span class="hljs-keyword">void</span>)touchesEnded:(<span class="hljs-built_in">NSSet</span> *)touches withEvent:(UIEvent *)event;
</code></pre>
</li>
<li>触摸取消（可能会经历）<pre><code class="lang-objc">- (<span class="hljs-keyword">void</span>)touchesCancelled:(<span class="hljs-built_in">NSSet</span> *)touches withEvent:(UIEvent *)event;
</code></pre>
</li>
<li>注意<pre><code>一次完整的触摸过程中，只会产生一个事件对象，4个触摸方法都是同一个event参数
如果两根手指同时触摸一个view，那么view只会调用一次touchesBegan:withEvent:方法，touches参数中装着2个UITouch对象
如果这两根手指一前一后分开触摸同一个view，那么view会分别调用2次touchesBegan:withEvent:方法，并且每次调用时的touches参数中只包含一个UITouch对象
</code></pre></li>
</ul>
</li>
</ul>
<hr>
<h4 id="view">最合适的view</h4>
<ul>
<li>寻找最合适的view<ol>
<li>先判断自己是否可以接收触摸事件，如果可以进行下一步</li>
<li>判断触摸的点是否在自己上</li>
<li>如果在自己上，从后往前遍历子控件，子控件重复上述两步</li>
<li>如果没有符合条件的子控件，那么它自己就是最合适的view</li>
</ol>
</li>
<li><code>hitTest</code>方法与<code>pointInside</code>方法<ul>
<li>使用<pre><code class="lang-objc"><span class="hljs-comment">/**
*  寻找最合适的view
*  point：当前手指所在的点
*  event：产生的事件
*  返回值：最合适的view
*  调用：只要一个事件传递给一个控件，就会调用这个控件的hitTest方法
*/</span>
- (<span class="hljs-built_in">UIView</span> *)hitTest:(<span class="hljs-built_in">CGPoint</span>) withEvent:(UIEvent *)event;
<span class="hljs-comment">/**
*  判断point在不在方法的调用者上
*  point：必须是调用者的坐标系
*  调用：hitTest底层会调用
*/</span>
- (<span class="hljs-built_in">BOOL</span>)pointInside:(<span class="hljs-built_in">CGPoint</span>)point withEvent:(UIEvent *)event;
</code></pre>
</li>
<li>底层实现<ol>
<li>判断当前能否接收事件<pre><code class="lang-objc"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">self</span><span class="hljs-variable">.userInteractionEnabled</span> == <span class="hljs-literal">NO</span> || <span class="hljs-keyword">self</span><span class="hljs-variable">.hidden</span> == <span class="hljs-literal">YES</span> || <span class="hljs-keyword">self</span><span class="hljs-variable">.alpha</span> &lt;= <span class="hljs-number">0.01</span>) 
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
</code></pre>
</li>
<li>判断触摸点在不在当前控件上<pre><code class="lang-objc"><span class="hljs-keyword">if</span> (![<span class="hljs-keyword">self</span> pointInside:point withEvent:event])
    <span class="hljs-keyword">return</span> <span class="hljs-literal">nil</span>;
</code></pre>
</li>
<li>从后往前遍历子控件<pre><code class="lang-objc"><span class="hljs-keyword">int</span> count = (<span class="hljs-keyword">int</span>)<span class="hljs-keyword">self</span><span class="hljs-variable">.subviews</span><span class="hljs-variable">.count</span>;
<span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = count - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--) {
     <span class="hljs-built_in">UIView</span> *childView = <span class="hljs-keyword">self</span><span class="hljs-variable">.subViews</span>[i];
     <span class="hljs-comment">// 转换坐标系</span>
     <span class="hljs-built_in">CGPoint</span> childPoint = [<span class="hljs-keyword">self</span> convertPoint:point toView:childView];
     <span class="hljs-comment">// 判断是否最合适</span>
     <span class="hljs-built_in">UIView</span> *fitView = [child hitTest:childPoint withEvent:event];
     <span class="hljs-comment">// 如果最适合，就直接返回</span>
     <span class="hljs-keyword">if</span> (fitView) {
         <span class="hljs-keyword">return</span> fitView;
     }
}
</code></pre>
</li>
<li>自己就是最合适的View<pre><code class="lang-objc"><span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>;
</code></pre>
</li>
</ol>
</li>
</ul>
</li>
</ul>
<hr>
<h4 id="">事件响应</h4>
<ul>
<li>响应者链条 <ul>
<li>是由多个响应者对象连接起来的链条</li>
</ul>
</li>
<li>响应者对象<ul>
<li>继承了<code>UIResponder</code>的对象称之为响应者对象，用来处理事件的对象</li>
</ul>
</li>
<li>事件传递<ul>
<li>在产生一个事件时，系统会将该事件加入到一个由<code>UIApplication</code>管理的事件队列中</li>
<li><code>UIApplication</code>会从事件队列中取出最前面的事件，将它传递给先发送事件给应用程序的主窗口</li>
<li>主窗口会调用<code>hitTest</code>方法寻找最适合的视图控件，找到后就会调用视图控件的touches方法来做具体的事情</li>
<li>当调用touches方法，它的默认做法，就会将事件顺着响应者链条往上传递，传递给上一个响应者，接着就会调用上一个响应者的touches方法</li>
</ul>
</li>
<li>上一个响应者<ul>
<li>如果当前的View是控制器的View，那么控制器就是上一个响应者</li>
<li>如果当前的View不是控制器的View，那么它的父控件就是上一个响应者 </li>
<li>在视图层次结构的最顶级视图，如果也不能处理收到的事件或消息，则其将事件或消息传递给window对象进行处理</li>
<li>如果window对象也不处理，则其将事件或消息传递给UIApplication对象</li>
<li>如果UIApplication也不能处理该事件或消息，则将其丢弃 </li>
</ul>
</li>
</ul>
<hr>
<h4 id="">手势识别</h4>
<ul>
<li>手势识别器<ul>
<li><code>UIGestureRecognizer</code>苹果官方推出的手势识别功能</li>
<li>可以轻松识别用户在某个View上的常见手势</li>
<li>是一个抽象类，定义了所有手势的基本行为，使用其子类就可以处理具体的手势</li>
<li>几种常见手势<pre><code class="lang-objc">UITapGestureRecognizer       <span class="hljs-comment">// 敲击</span>
UIPinchGestureRecognizer     <span class="hljs-comment">// 捏合，用于缩放</span>
UIPanGestureRecognizer       <span class="hljs-comment">// 拖拽</span>
UISwipeGestureRecognizer     <span class="hljs-comment">// 轻扫</span>
UIRotationGestureRecognizer  <span class="hljs-comment">// 旋转</span>
UILongPressGestureRecognizer <span class="hljs-comment">// 长按</span>
</code></pre>
</li>
</ul>
</li>
<li><p>手势的使用</p>
<ul>
<li><p>点按手势</p>
<pre><code class="lang-objc"><span class="hljs-comment">// Target：当哪对象要坚听手势</span>
<span class="hljs-comment">// action：手势发生时调用的方法</span>
UITapGestureRecognizer *tap = [[UITapGestureRecognizer alloc] initWithTarget:<span class="hljs-keyword">self</span> action:<span class="hljs-keyword">@selector</span>(tap)];
<span class="hljs-comment">// 手势也可以设置代理</span>
tap<span class="hljs-variable">.delegate</span> = <span class="hljs-keyword">self</span>;
<span class="hljs-comment">// 添加手势</span>
[<span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span> addGestureRecognizer:tap];

<span class="hljs-comment">// 手指开始点击时调用</span>
- (<span class="hljs-keyword">void</span>)tap {
      <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@"%s"</span>, __func__);
}

<span class="hljs-comment">// 手势代理方法</span>
- (<span class="hljs-built_in">BOOL</span>)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch {
     <span class="hljs-comment">// 获取当前手指所在的点</span>
     <span class="hljs-built_in">CGPoint</span> curP = [touch locationInView:<span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span>];
}
</code></pre>
</li>
<li>长按手势<pre><code class="lang-objc">UILongPressGestureRecognizer *longP = [[UILongPressGestureRecognizer alloc] initWithTarget:<span class="hljs-keyword">self</span> action:<span class="hljs-keyword">@selector</span>(longPress:)];
<span class="hljs-comment">// 添加手势</span>
[<span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span> addGestureRecognizer:longP];
<span class="hljs-comment">// 当手指长按时调用</span>
<span class="hljs-comment">// 注意，长按手势会调用多次，当开始长按时会调用，当长按松开时会调用，当长按移动时，也会调用</span>
<span class="hljs-comment">// 一般我们都是在长按刚开始时做事情，所以要判断它的状</span>
<span class="hljs-comment">// 这个状态是保存的当前的手势当中 所以要把当前的长按手势传进来，来判断当前手势的状态</span>
- (<span class="hljs-keyword">void</span>)longPress:(UILongPressGestureRecognizer *)longP {
    <span class="hljs-comment">// 手势的状态是一个枚举UIGestureRecognizerState，可以进入头文件当中查看</span>
    <span class="hljs-keyword">if</span> (longP<span class="hljs-variable">.state</span> == UIGestureRecognizerStateBegan) {
         <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@"开始长按时调用"</span>);
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (longP<span class="hljs-variable">.state</span> == UIGestureRecognizerStateChanged) {
         <span class="hljs-comment">// 会持续调用</span>
         <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@"当长按拖动时调用"</span>);
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (longP<span class="hljs-variable">.state</span> == UIGestureRecognizerStateEnded) {
         <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@"当长按松手指松开进调用"</span>);
    }
}
</code></pre>
</li>
<li>轻扫手势<pre><code class="lang-objc">UISwipeGestureRecognizer *swipe = [[UISwipeGestureRecognizer alloc] initWithTarget:<span class="hljs-keyword">self</span> action:<span class="hljs-keyword">@selector</span>(swipe:)];
<span class="hljs-comment">// 注意：轻扫手势默认轻扫的方向是往右轻扫，可以去手动修改轻扫的方向</span>
<span class="hljs-comment">// 一个手势只能对象一个方向，想要支持多个方向的轻扫，要添加多个轻扫手势</span>
swipe<span class="hljs-variable">.direction</span> = UISwipeGestureRecognizerDirectionLeft;
<span class="hljs-comment">// 添加手势</span>
[<span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span> addGestureRecognizer:swipe];
</code></pre>
</li>
<li>平移手势<pre><code class="lang-objc">UIPanGestureRecognizer *pan = [[UIPanGestureRecognizer alloc] initWithTarget:<span class="hljs-keyword">self</span> action:<span class="hljs-keyword">@selector</span>(pan:)];
<span class="hljs-comment">// 添加手势</span>
[<span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span> addGestureRecognizer:pan];
<span class="hljs-comment">// 实现手势方法</span>
<span class="hljs-comment">// 手指在屏幕上移动进调用</span>
- (<span class="hljs-keyword">void</span>)pan:(UIPanGestureRecognizer *)pan{
     <span class="hljs-comment">// 获取当前手指移动的偏移量</span>
     <span class="hljs-built_in">CGPoint</span> transP =  [pan translationInView:<span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span>];
      <span class="hljs-built_in">NSLog</span>(<span class="hljs-string">@"%@"</span>, NSStringFromCGPoint(transP));
     <span class="hljs-comment">// Make它会清空上一次的形变</span>
     <span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span><span class="hljs-variable">.transform</span> = CGAffineTransformMakeTranslation(transP<span class="hljs-variable">.x</span>, transP<span class="hljs-variable">.y</span>);
     <span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span><span class="hljs-variable">.transform</span> = CGAffineTransformTranslate(<span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span><span class="hljs-variable">.transform</span>, transP<span class="hljs-variable">.x</span>, transP<span class="hljs-variable">.y</span>);
     <span class="hljs-comment">// 复位，相对于上一次</span>
     [pan setTranslation:CGPointZero inView:<span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span>];
}
</code></pre>
</li>
<li><p>旋转手势</p>
<pre><code class="lang-objc"><span class="hljs-comment">// 添加旋转手势</span>
UIRotationGestureRecognizer *rotation = [[UIRotationGestureRecognizer alloc] initWithTarget:<span class="hljs-keyword">self</span> action:<span class="hljs-keyword">@selector</span>(rotation:)];
<span class="hljs-comment">// 设置代理，设置代理的目的就让它能够同时支持旋转跟缩放</span>
rotation<span class="hljs-variable">.delegate</span> = <span class="hljs-keyword">self</span>;
<span class="hljs-comment">// 添加手势</span>
[<span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span> addGestureRecognizer:rotation];
<span class="hljs-comment">// 当旋转时调用</span>
- (<span class="hljs-keyword">void</span>)rotation:(UIRotationGestureRecognizer *)rotation {
     <span class="hljs-comment">// 旋转也是相对于上一次</span>
     <span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span><span class="hljs-variable">.transform</span> = CGAffineTransformRotate(<span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span><span class="hljs-variable">.transform</span>, rotation<span class="hljs-variable">.rotation</span>);
     <span class="hljs-comment">// 设置代理,设置代理的目的就让它能够同时支持旋转跟缩放</span>
     rotation<span class="hljs-variable">.delegate</span> = <span class="hljs-keyword">self</span>;
     <span class="hljs-comment">// 也要做复位操作</span>
     rotation<span class="hljs-variable">.rotation</span> = <span class="hljs-number">0</span>;
}
</code></pre>
</li>
<li><p>缩放手势</p>
<pre><code class="lang-objc"><span class="hljs-comment">// 添加缩放手势</span>
UIPinchGestureRecognizer *pinch = [[UIPinchGestureRecognizer alloc] initWithTarget:<span class="hljs-keyword">self</span> action:<span class="hljs-keyword">@selector</span>(pinch:)];
<span class="hljs-comment">// 添加手势</span>
[<span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span> addGestureRecognizer:pinch];
<span class="hljs-comment">// 缩放手势时调用</span>
- (<span class="hljs-keyword">void</span>)pinch:(UIPinchGestureRecognizer *)pinch {
     <span class="hljs-comment">// 平移也是相对于上一次</span>
     <span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span><span class="hljs-variable">.transform</span> = CGAffineTransformScale(<span class="hljs-keyword">self</span><span class="hljs-variable">.imageV</span><span class="hljs-variable">.transform</span>, pinch<span class="hljs-variable">.scale</span>, pinch<span class="hljs-variable">.scale</span>);
     <span class="hljs-comment">// 复位</span>
     pinch<span class="hljs-variable">.scale</span> = <span class="hljs-number">1</span>;
}
</code></pre>
</li>
</ul>
</li>
</ul>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../day_11/README.html" class="navigation navigation-prev " aria-label="Previous page: day 11"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../day_13/README.html" class="navigation navigation-next " aria-label="Next page: day 13"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="https://cdn.mathjax.org/mathjax/2.4-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
